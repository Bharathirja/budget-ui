import{c as ve}from"./chunk-IIPI6WYD.js";import{a as pt,b as ct}from"./chunk-NZGFDPBT.js";import{$ as Qe,Aa as W,C as xe,Ca as Je,D as S,Da as Y,E as De,Ea as K,F as Fe,Fa as Xe,G as Ee,Ga as Ze,H as M,Ha as et,I as Ie,Ia as tt,J as ke,Ja as it,K as Ve,Ka as at,L as Re,La as nt,M as P,Ma as ot,N as L,Na as rt,Oa as mt,P as Pe,Pa as st,Q as Le,Qa as lt,R as ze,Ra as oe,S as z,Sa as U,T as A,U as Ae,V as Ne,Y as N,Z as qe,_ as Oe,aa as q,ba as O,ca as Q,da as H,ea as $,fa as He,g as Se,ga as B,h as Me,ha as $e,i as be,ia as Be,ja as je,k as R,ka as j,p as ye,pa as Ge,q as we,qa as We,ra as Ye,ta as Ke,ua as G,z as Te,za as Ue}from"./chunk-H2R5YDVN.js";import{$b as _,Ca as le,Cc as ne,Dc as fe,E as se,Ec as Ce,Fc as _e,Hb as X,Ib as Z,Jb as pe,Lb as D,Mb as F,Nb as c,Ob as a,Pb as o,Qb as C,Ub as E,Vb as I,Xb as k,bb as l,bc as f,f as y,fa as w,fc as ee,gc as te,hc as ie,la as h,lc as b,ma as g,nb as v,pc as m,q as J,qc as V,rc as ae,sb as T,tc as ce,uc as ue,vb as x,vc as de,yc as he,zc as ge}from"./chunk-RLIR3CAQ.js";import{a as re,b as me}from"./chunk-RGL3W33T.js";function _t(n,r){if(n&1){let p=k();a(0,"div",3)(1,"mat-form-field",10)(2,"input",11),_("keyup",function(e){h(p);let i=f();return g(i.onSearch(e))}),o()()()}if(n&2){let p=f();l(2),c("value",p.searchValue)}}function St(n,r){if(n&1&&(a(0,"th",14),m(1),ne(2,"titlecase"),o()),n&2){let p=f(),t=p.$implicit,e=p.$index,i=f();l(),ae(" ",i.headersColumns&&i.headersColumns[e]?i.headersColumns[e]:fe(2,1,t)," ")}}function Mt(n,r){if(n&1&&(E(0),a(1,"button",18)(2,"mat-icon"),m(3,"more_vert"),o()(),a(4,"mat-menu",null,1)(6,"button",19)(7,"mat-icon"),m(8,"add"),o(),a(9,"span"),m(10,"Add"),o()(),a(11,"button",19)(12,"mat-icon"),m(13,"edit"),o(),a(14,"span"),m(15,"Edit"),o()(),a(16,"button",19)(17,"mat-icon"),m(18,"delete"),o(),a(19,"span"),m(20,"Delete"),o()()(),I()),n&2){let p=b(5);l(),c("matMenuTriggerFor",p)}}function bt(n,r){if(n&1&&(E(0),m(1),ne(2,"date"),I()),n&2){let p=f().$implicit,t=f().$implicit;l(),ae(" ",Ce(2,1,p[t],"short")," ")}}function yt(n,r){if(n&1&&m(0),n&2){let p=f().$implicit,t=f().$implicit;V(p[t])}}function wt(n,r){if(n&1&&(a(0,"td",15),T(1,Mt,21,1,"ng-container",16)(2,bt,3,4,"ng-container",17)(3,yt,1,1,"ng-template",null,0,_e),o()),n&2){let p=r.$implicit,t=b(4),e=f().$implicit;l(),c("ngIf",e==="action"),l(),c("ngIf",e==="created_at"&&p[e]&&e!=="action")("ngIfElse",t)}}function vt(n,r){if(n&1&&(E(0,5),T(1,St,3,3,"th",12)(2,wt,5,3,"td",13),I()),n&2){let p=r.$implicit;c("matColumnDef",p)}}function Tt(n,r){n&1&&C(0,"tr",20)}function xt(n,r){n&1&&C(0,"tr",21)}function Dt(n,r){n&1&&(a(0,"div",8),m(1,"No results found"),o())}var ut=(()=>{let r=class r{constructor(){this.columns=[],this.displayedColumns=[],this.headersColumns=[],this.data=[],this.pageSize=10,this.resultsLength=0,this.isLoadingResults=!1,this.showSearch=!0,this.search=new x,this.pageChange=new x,this.sortChange=new x,this.showActions=!1,this.dataSource=new oe,this.searchSubject=new y,this.searchValue=""}ngOnInit(){this.updateDataSource(),this.searchSubject.pipe(se(300)).subscribe(t=>{this.search.emit(t)})}ngOnChanges(){this.updateDataSource()}updateDataSource(){this.dataSource=new oe(this.data)}onSearch(t){let e=t.target.value;this.searchValue=e,this.searchSubject.next(e)}onPageChange(t){this.pageChange.emit({pageIndex:t.pageIndex,pageSize:t.pageSize})}onSortChange(t){this.sortChange.emit(t)}};r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=v({type:r,selectors:[["app-common-table"]],viewQuery:function(e,i){if(e&1&&(ee(Y,5),ee(K,5)),e&2){let s;te(s=ie())&&(i.paginator=s.first),te(s=ie())&&(i.sort=s.first)}},inputs:{columns:"columns",displayedColumns:"displayedColumns",headersColumns:"headersColumns",data:"data",pageSize:"pageSize",resultsLength:"resultsLength",isLoadingResults:"isLoadingResults",showSearch:"showSearch",showActions:"showActions"},outputs:{search:"search",pageChange:"pageChange",sortChange:"sortChange"},features:[le],decls:9,vars:7,consts:[["defaultCell",""],["menu","matMenu"],[1,"table-responsive"],[1,"mb-3","col-lg-4","p-l-0"],["mat-table","","matSort","",1,"w-100",3,"matSortChange","dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"text-center","p-4","f-s-16","f-w-600"],["showFirstLastButtons","",3,"page","length","pageSize"],["appearance","outline",1,"w-100"],["matInput","","placeholder","Search...",3,"keyup","value"],["mat-header-cell","","mat-sort-header","","class","f-w-600 f-s-14",4,"matHeaderCellDef"],["mat-cell","","class","f-w-600",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"f-w-600","f-s-14"],["mat-cell","",1,"f-w-600"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["mat-menu-item",""],["mat-header-row",""],["mat-row",""]],template:function(e,i){e&1&&(a(0,"div",2),X(1,_t,3,1,"div",3),a(2,"table",4),_("matSortChange",function(d){return i.onSortChange(d)}),D(3,vt,3,1,"ng-container",5,pe),T(5,Tt,1,0,"tr",6)(6,xt,1,0,"tr",7),o(),X(7,Dt,2,0,"div",8),a(8,"mat-paginator",9),_("page",function(d){return i.onPageChange({pageIndex:d.pageIndex,pageSize:d.pageSize})}),o()()),e&2&&(l(),Z(i.showSearch?1:-1),l(),c("dataSource",i.dataSource),l(),F(i.columns),l(2),c("matHeaderRowDef",i.displayedColumns),l(),c("matRowDefColumns",i.displayedColumns),l(),Z(i.dataSource.data.length===0?7:-1),l(),c("length",i.resultsLength)("pageSize",i.pageSize))},dependencies:[O,z,B,P,L,$,H,Q,A,lt,Ze,tt,ot,it,et,rt,at,nt,mt,st,R,Se,G,U,Be,$e,je,Ae,Ue,Y,K,Xe,W,j,N,q,Me,be],styles:[".table-responsive[_ngcontent-%COMP%]{width:100%}.text-center[_ngcontent-%COMP%]{text-align:center}.p-4[_ngcontent-%COMP%]{padding:1.5rem}.f-s-16[_ngcontent-%COMP%]{font-size:16px}.f-w-600[_ngcontent-%COMP%]{font-weight:600}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem}"]});let n=r;return n})();var Ft=()=>["Transaction Name","Amount","Quantity/Kg","Total Amount","Date","Actions"],Et=(n,r)=>r.value;function It(n,r){if(n&1&&(a(0,"mat-option",14),m(1),o()),n&2){let p=r.$implicit;c("value",p.value),l(),V(p.viewValue)}}var dt=(()=>{let r=class r{constructor(){this.sortField="",this.sortDirection="",this.searchSubject=new y,this.currentSearchQuery="",this.apiService=w(pt),this.selectedCategory="",this.category=[],this.router=w(ve),this.transactionForm=new Ee({transaction_name:new M("",S.required),category:new M("",S.required),amount:new M("",[S.required,S.min(.01)]),quantity_or_kg:new M("",[S.required,S.min(.01)]),date:new M(new Date,S.required)}),this.columns=["transaction_name","amount","quantity_or_kg","total_amount","created_at","action"],this.displayedColumns=["transaction_name","amount","quantity_or_kg","total_amount","created_at"],this.pageSize=10,this.pageIndex=0,this.data=[],this.resultsLength=0,this.isLoadingResults=!0,this.apiEndpoint="http://127.0.0.1:8000/api/v1/budget/transactions/",this.http=w(we)}navigateToCategory(){this.router.navigate(["budget/category"]),console.log("Navigating to category management page...")}ngOnInit(){this.getCategories()}ngAfterViewInit(){this.loadData()}onSubmit(){if(this.transactionForm.valid){let t={transaction_name:this.transactionForm.value.transaction_name,category:this.selectedCategory,amount:this.transactionForm.value.amount,quantity_or_kg:this.transactionForm.value.quantity_or_kg,date:this.transactionForm.value.date?.toISOString().split("T")[0]};this.apiService.addTransaction(t).subscribe({next:e=>{console.log("Transaction added successfully",e),this.onCancel(),this.loadData()},error:e=>{console.error("Error adding transaction",e)}})}else console.log("Form is not valid")}onCancel(){this.transactionForm.controls.date.setValue(new Date),this.transactionForm.reset(),this.transactionForm.markAsPristine(),this.transactionForm.markAsUntouched(),this.transactionForm.updateValueAndValidity}loadData(t){this.isLoadingResults=!0;let e=new ye,i=this.pageIndex+1;if(e=e.set("page",i.toString()),e=e.set("page_size",this.pageSize.toString()),this.sortField&&this.sortDirection){let s=`${this.sortDirection==="desc"?"-":""}${this.sortField}`;e=e.set("ordering",s)}t&&(e=e.set("search",t)),this.apiService.getTransactions(e).pipe(J(s=>(this.isLoadingResults=!1,this.resultsLength=s.count,s.results.map(u=>me(re({},u),{total_amount:u.amount*u.quantity_or_kg}))))).subscribe(s=>{this.data=s})}onTableSearch(t){this.currentSearchQuery=t,this.pageIndex=0,this.loadData(this.currentSearchQuery)}onTablePage(t){this.pageIndex=t.pageIndex,this.pageSize=t.pageSize,this.loadData(this.currentSearchQuery)}onTableSort(t){this.sortField=t.active,this.sortDirection=t.direction,this.loadData(this.currentSearchQuery)}applyFilter(t){let e=t.target.value;this.searchSubject.next(e)}getCategories(){this.apiService.getCategories().pipe(J(t=>t.results.map(e=>({value:e.id,viewValue:e.category_name})))).subscribe(t=>{this.category=t,this.selectedCategory=this.category[0].value})}};r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=v({type:r,selectors:[["app-transactions"]],features:[he([Je()])],decls:59,vars:15,consts:[["picker",""],[1,"cardWithShadow","theme-card"],[1,"m-b-0"],[1,"b-t-1"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-lg-6"],[1,"f-w-600","m-b-8","d-block"],[1,"text-error"],["appearance","outline","color","primary",1,"w-100"],["matInput","","placeholder","Enter Transaction ","formControlName","transaction_name"],["type","button","mat-flat-button","","color","primary",1,"mini-btn",3,"click"],["appearance","outline",1,"w-100"],["formControlName","category","placeholder","Select Category",3,"valueChange","value"],[3,"value"],["matInput","","type","number","placeholder","Enter Amount","formControlName","amount"],["matInput","","type","number","placeholder","Enter Quantity/Kg","formControlName","quantity_or_kg"],["matInput","","formControlName","date","placeholder","Choose a date",3,"matDatepicker"],[1,"p-l-0"],["matIconSuffix","",3,"for"],[1,"m-t-12"],["mat-flat-button","","color","primary","type","submit",1,"m-r-8",3,"disabled"],["mat-stroked-button","","color","warn","type","button",3,"click"],[1,"cardWithShadow"],[3,"search","pageChange","sortChange","columns","displayedColumns","data","headersColumns","pageSize","resultsLength","isLoadingResults","showSearch","showActions"]],template:function(e,i){if(e&1){let s=k();a(0,"mat-card",1)(1,"mat-card-header")(2,"mat-card-title",2),m(3,"Make Transaction"),o()(),a(4,"mat-card-content",3)(5,"form",4),_("ngSubmit",function(){return h(s),g(i.onSubmit())}),a(6,"div",5)(7,"div",6)(8,"mat-label",7),m(9,"Name "),a(10,"span",8),m(11,"*"),o()(),a(12,"mat-form-field",9),C(13,"input",10),o()(),a(14,"div",6)(15,"mat-label",7),m(16,"Category "),a(17,"span",8),m(18,"*"),o(),a(19,"button",11),_("click",function(){return h(s),g(i.navigateToCategory())}),m(20,"+"),o()(),a(21,"mat-form-field",12)(22,"mat-select",13),de("valueChange",function(u){return h(s),ue(i.selectedCategory,u)||(i.selectedCategory=u),g(u)}),D(23,It,2,2,"mat-option",14,Et),o()()(),a(25,"div",6)(26,"mat-label",7),m(27,"Amount "),a(28,"span",8),m(29,"*"),o()(),a(30,"mat-form-field",9),C(31,"input",15),o()(),a(32,"div",6)(33,"mat-label",7),m(34,"Quantity/Kg "),a(35,"span",8),m(36,"*"),o()(),a(37,"mat-form-field",9),C(38,"input",16),o()(),a(39,"div",6)(40,"mat-label",7),m(41,"Date "),a(42,"span",8),m(43,"*"),o()(),a(44,"mat-form-field",9),C(45,"input",17),a(46,"mat-hint",18),m(47,"MM/DD/YYYY"),o(),C(48,"mat-datepicker-toggle",19)(49,"mat-datepicker",null,0),o()()(),a(51,"div",20)(52,"button",21),m(53,"Submit"),o(),a(54,"button",22),_("click",function(){return h(s),g(i.onCancel())}),m(55,"Cancel"),o()()()()(),a(56,"mat-card",23)(57,"mat-card-content")(58,"app-common-table",24),_("search",function(u){return h(s),g(i.onTableSearch(u))})("pageChange",function(u){return h(s),g(i.onTablePage(u))})("sortChange",function(u){return h(s),g(i.onTableSort(u))}),o()()()}if(e&2){let s=b(50);l(5),c("formGroup",i.transactionForm),l(17),ce("value",i.selectedCategory),l(),F(i.category),l(22),c("matDatepicker",s),l(3),c("for",s),l(4),c("disabled",i.transactionForm.invalid),l(6),c("columns",i.columns)("displayedColumns",i.columns)("data",i.data)("headersColumns",ge(14,Ft))("pageSize",i.pageSize)("resultsLength",i.resultsLength)("isLoadingResults",i.isLoadingResults)("showSearch",!0)("showActions",!0)}},dependencies:[O,z,Pe,Le,ze,B,He,Te,P,Ie,xe,ke,De,Fe,L,Ve,Re,$,N,Ne,G,Ge,Ye,Ke,We,H,Q,A,R,U,qe,Oe,Qe,W,j,q,ut],styles:[".mini-btn[_ngcontent-%COMP%]{min-width:24px;height:24px;line-height:16px;padding:0 6px;font-size:16px;text-align:center;cursor:pointer}"]});let n=r;return n})();var Qi=[{path:"",children:[{path:"category",component:ct},{path:"transactions",component:dt}]}];export{Qi as UiComponentsRoutes};
